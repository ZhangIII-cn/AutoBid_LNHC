# Form implementation generated from reading ui file 'demo.ui'
#
# Created by: PyQt6 UI code generator 6.4.2
#
# WARNING: Any manual changes made to this file will be lost when pyuic6 is
# run again.  Do not edit this file unless you know what you are doing.

from PyQt6 import QtCore, QtGui, QtWidgets
from PyQt6.QtCore import Qt, QSize, QThread, pyqtSignal
from PyQt6.QtWidgets import (
    QApplication, QWidget, QPushButton, QMainWindow, QLabel, QHBoxLayout, QVBoxLayout, QLineEdit, QMessageBox,
    QFileDialog,QDialog)
from Mylib.Function_Spider import *
from dialog import Ui_Dialog
import threading

#---------------全局变量--------------------------------------------------------------------------------------------------------
Counter_Page_Finished=0
Counter_Page_Number=10
Flag_Finished_Spider=False
task_done_event = threading.Event()

class Thread_Spider(QThread):
    Signal_Finish = pyqtSignal()
    Index_ProgressBar= pyqtSignal(int,int)

    def run(self):
        for i in range(0,Counter_Page_Number):
            # print(str(i) + '/' + str(Counter_Page_Finished))
            self.Index_ProgressBar.emit(i,Counter_Page_Number)
            time.sleep(0.5)

        Spider_Work()
        self.Signal_Finish.emit() #Signal transferred to main thread.
        # task_done_event.set()

class Ui_MainWindow(QtWidgets.QMainWindow):
    def __init__(self):
        super(Ui_MainWindow, self).__init__()
        self.setupUi(self)
        self.retranslateUi(self)

    def click_start(self):
        #----------------------- Show Dialog UI -------------------------------------------------------------------------------------------
        self.dialog = QDialog(self)
        ui = Ui_Dialog()
        ui.setupUi(self.dialog)
        self.dialog.show()
        #---------------------—— 多线程实现爬虫功能与QT进度条的同步 -----------------------------------------------------------------------------
        self.thread=Thread_Spider()
        self.thread.Signal_Finish.connect(self.on_Thread_Spider_Finished)
        self.thread.Index_ProgressBar.connect(self.on_Thread_Data_Changed)
        self.thread.start()
        # task_done_event.wait()

    def on_Thread_Spider_Finished(self):
        print("Spider Finished!")

    def on_Thread_Data_Changed(self,index,value):
        print(index,value)

    def setupUi(self, MainWindow):
        MainWindow.setObjectName("MainWindow")
        MainWindow.setWindowModality(QtCore.Qt.WindowModality.WindowModal)
        MainWindow.resize(865, 576)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Fixed, QtWidgets.QSizePolicy.Policy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(MainWindow.sizePolicy().hasHeightForWidth())
        MainWindow.setSizePolicy(sizePolicy)
        MainWindow.setMinimumSize(QtCore.QSize(0, 0))
        MainWindow.setDocumentMode(False)
        MainWindow.setTabShape(QtWidgets.QTabWidget.TabShape.Rounded)
        MainWindow.setDockOptions(QtWidgets.QMainWindow.DockOption.AllowTabbedDocks|QtWidgets.QMainWindow.DockOption.AnimatedDocks)
        self.centralwidget = QtWidgets.QWidget(parent=MainWindow)
        self.centralwidget.setObjectName("centralwidget")
        self.label = QtWidgets.QLabel(parent=self.centralwidget)
        self.label.setGeometry(QtCore.QRect(100, 90, 91, 31))
        font = QtGui.QFont()
        font.setPointSize(14)
        font.setBold(False)
        self.label.setFont(font)
        self.label.setWordWrap(False)
        self.label.setObjectName("label")
        self.comboBox = QtWidgets.QComboBox(parent=self.centralwidget)
        self.comboBox.setGeometry(QtCore.QRect(200, 90, 211, 31))
        font = QtGui.QFont()
        font.setPointSize(12)
        self.comboBox.setFont(font)
        self.comboBox.setObjectName("comboBox")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.label_2 = QtWidgets.QLabel(parent=self.centralwidget)
        self.label_2.setGeometry(QtCore.QRect(110, 160, 71, 31))
        font = QtGui.QFont()
        font.setPointSize(14)
        font.setBold(False)
        self.label_2.setFont(font)
        self.label_2.setWordWrap(False)
        self.label_2.setObjectName("label_2")
        self.horizontalLayoutWidget = QtWidgets.QWidget(parent=self.centralwidget)
        self.horizontalLayoutWidget.setGeometry(QtCore.QRect(200, 150, 131, 51))
        self.horizontalLayoutWidget.setObjectName("horizontalLayoutWidget")
        self.horizontalLayout = QtWidgets.QHBoxLayout(self.horizontalLayoutWidget)
        self.horizontalLayout.setContentsMargins(0, 0, 0, 0)
        self.horizontalLayout.setObjectName("horizontalLayout")
        self.Button_AddWord = QtWidgets.QPushButton(parent=self.horizontalLayoutWidget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Maximum, QtWidgets.QSizePolicy.Policy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.Button_AddWord.sizePolicy().hasHeightForWidth())
        self.Button_AddWord.setSizePolicy(sizePolicy)
        self.Button_AddWord.setMinimumSize(QtCore.QSize(100, 0))
        font = QtGui.QFont()
        font.setPointSize(10)
        self.Button_AddWord.setFont(font)
        self.Button_AddWord.setObjectName("Button_AddWord")
        self.horizontalLayout.addWidget(self.Button_AddWord)
        self.label_3 = QtWidgets.QLabel(parent=self.centralwidget)
        self.label_3.setGeometry(QtCore.QRect(100, 230, 81, 31))
        font = QtGui.QFont()
        font.setPointSize(14)
        font.setBold(False)
        self.label_3.setFont(font)
        self.label_3.setWordWrap(False)
        self.label_3.setObjectName("label_3")
        self.horizontalLayoutWidget_2 = QtWidgets.QWidget(parent=self.centralwidget)
        self.horizontalLayoutWidget_2.setGeometry(QtCore.QRect(200, 220, 431, 51))
        self.horizontalLayoutWidget_2.setObjectName("horizontalLayoutWidget_2")
        self.horizontalLayout_2 = QtWidgets.QHBoxLayout(self.horizontalLayoutWidget_2)
        self.horizontalLayout_2.setContentsMargins(0, 0, 0, 0)
        self.horizontalLayout_2.setObjectName("horizontalLayout_2")
        self.radio_1 = QtWidgets.QRadioButton(parent=self.horizontalLayoutWidget_2)
        font = QtGui.QFont()
        font.setPointSize(10)
        self.radio_1.setFont(font)
        self.radio_1.setObjectName("radio_1")
        self.horizontalLayout_2.addWidget(self.radio_1)
        self.radio_2 = QtWidgets.QRadioButton(parent=self.horizontalLayoutWidget_2)
        font = QtGui.QFont()
        font.setPointSize(10)
        self.radio_2.setFont(font)
        self.radio_2.setObjectName("radio_2")
        self.horizontalLayout_2.addWidget(self.radio_2)
        self.radio_3 = QtWidgets.QRadioButton(parent=self.horizontalLayoutWidget_2)
        font = QtGui.QFont()
        font.setPointSize(10)
        self.radio_3.setFont(font)
        self.radio_3.setObjectName("radio_3")
        self.horizontalLayout_2.addWidget(self.radio_3)
        self.radio_4 = QtWidgets.QRadioButton(parent=self.horizontalLayoutWidget_2)
        font = QtGui.QFont()
        font.setPointSize(10)
        self.radio_4.setFont(font)
        self.radio_4.setObjectName("radio_4")
        self.horizontalLayout_2.addWidget(self.radio_4)
        self.Button_Work = QtWidgets.QPushButton(parent=self.centralwidget)
        self.Button_Work.setGeometry(QtCore.QRect(360, 440, 131, 41))
        self.Button_Work.clicked.connect(self.click_start)

        font = QtGui.QFont()
        font.setPointSize(12)
        self.Button_Work.setFont(font)
        self.Button_Work.setObjectName("Button_Work")
        self.label_4 = QtWidgets.QLabel(parent=self.centralwidget)
        self.label_4.setGeometry(QtCore.QRect(100, 300, 81, 31))
        font = QtGui.QFont()
        font.setPointSize(14)
        font.setBold(False)
        self.label_4.setFont(font)
        self.label_4.setWordWrap(False)
        self.label_4.setObjectName("label_4")
        self.gridLayoutWidget = QtWidgets.QWidget(parent=self.centralwidget)
        self.gridLayoutWidget.setGeometry(QtCore.QRect(200, 290, 291, 96))
        font = QtGui.QFont()
        font.setPointSize(10)
        self.gridLayoutWidget.setFont(font)
        self.gridLayoutWidget.setObjectName("gridLayoutWidget")
        self.gridLayout = QtWidgets.QGridLayout(self.gridLayoutWidget)
        self.gridLayout.setContentsMargins(0, 0, 0, 0)
        self.gridLayout.setObjectName("gridLayout")
        self.CheckBox_JL = QtWidgets.QCheckBox(parent=self.gridLayoutWidget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Minimum, QtWidgets.QSizePolicy.Policy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.CheckBox_JL.sizePolicy().hasHeightForWidth())
        self.CheckBox_JL.setSizePolicy(sizePolicy)
        self.CheckBox_JL.setMinimumSize(QtCore.QSize(60, 0))
        font = QtGui.QFont()
        font.setPointSize(10)
        self.CheckBox_JL.setFont(font)
        self.CheckBox_JL.setObjectName("CheckBox_JL")
        self.gridLayout.addWidget(self.CheckBox_JL, 1, 2, 1, 1)
        self.CheckBox_ZJ = QtWidgets.QCheckBox(parent=self.gridLayoutWidget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Minimum, QtWidgets.QSizePolicy.Policy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.CheckBox_ZJ.sizePolicy().hasHeightForWidth())
        self.CheckBox_ZJ.setSizePolicy(sizePolicy)
        self.CheckBox_ZJ.setMinimumSize(QtCore.QSize(60, 0))
        font = QtGui.QFont()
        font.setPointSize(10)
        self.CheckBox_ZJ.setFont(font)
        self.CheckBox_ZJ.setObjectName("CheckBox_ZJ")
        self.gridLayout.addWidget(self.CheckBox_ZJ, 1, 0, 1, 1)
        self.CheckBox_LN = QtWidgets.QCheckBox(parent=self.gridLayoutWidget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Minimum, QtWidgets.QSizePolicy.Policy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.CheckBox_LN.sizePolicy().hasHeightForWidth())
        self.CheckBox_LN.setSizePolicy(sizePolicy)
        self.CheckBox_LN.setMinimumSize(QtCore.QSize(50, 0))
        font = QtGui.QFont()
        font.setPointSize(10)
        self.CheckBox_LN.setFont(font)
        self.CheckBox_LN.setObjectName("CheckBox_LN")
        self.gridLayout.addWidget(self.CheckBox_LN, 0, 1, 1, 1)
        self.CheckBox_HLJ = QtWidgets.QCheckBox(parent=self.gridLayoutWidget)
        self.CheckBox_HLJ.setMinimumSize(QtCore.QSize(60, 0))
        font = QtGui.QFont()
        font.setPointSize(10)
        self.CheckBox_HLJ.setFont(font)
        self.CheckBox_HLJ.setObjectName("CheckBox_HLJ")
        self.gridLayout.addWidget(self.CheckBox_HLJ, 1, 3, 1, 1)
        self.CheckBox_DL = QtWidgets.QCheckBox(parent=self.gridLayoutWidget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Minimum, QtWidgets.QSizePolicy.Policy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.CheckBox_DL.sizePolicy().hasHeightForWidth())
        self.CheckBox_DL.setSizePolicy(sizePolicy)
        self.CheckBox_DL.setMinimumSize(QtCore.QSize(60, 0))
        font = QtGui.QFont()
        font.setPointSize(10)
        self.CheckBox_DL.setFont(font)
        self.CheckBox_DL.setObjectName("CheckBox_DL")
        self.gridLayout.addWidget(self.CheckBox_DL, 0, 2, 1, 1)
        self.CheckBox_BJ = QtWidgets.QCheckBox(parent=self.gridLayoutWidget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Minimum, QtWidgets.QSizePolicy.Policy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.CheckBox_BJ.sizePolicy().hasHeightForWidth())
        self.CheckBox_BJ.setSizePolicy(sizePolicy)
        self.CheckBox_BJ.setMinimumSize(QtCore.QSize(50, 0))
        font = QtGui.QFont()
        font.setPointSize(10)
        self.CheckBox_BJ.setFont(font)
        self.CheckBox_BJ.setObjectName("CheckBox_BJ")
        self.gridLayout.addWidget(self.CheckBox_BJ, 1, 1, 1, 1)
        self.CheckBox_SD = QtWidgets.QCheckBox(parent=self.gridLayoutWidget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Maximum, QtWidgets.QSizePolicy.Policy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.CheckBox_SD.sizePolicy().hasHeightForWidth())
        self.CheckBox_SD.setSizePolicy(sizePolicy)
        self.CheckBox_SD.setMinimumSize(QtCore.QSize(60, 0))
        font = QtGui.QFont()
        font.setPointSize(10)
        self.CheckBox_SD.setFont(font)
        self.CheckBox_SD.setObjectName("CheckBox_SD")
        self.gridLayout.addWidget(self.CheckBox_SD, 0, 3, 1, 1)
        self.CheckBox_All = QtWidgets.QCheckBox(parent=self.gridLayoutWidget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Minimum, QtWidgets.QSizePolicy.Policy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.CheckBox_All.sizePolicy().hasHeightForWidth())
        self.CheckBox_All.setSizePolicy(sizePolicy)
        self.CheckBox_All.setMinimumSize(QtCore.QSize(60, 0))
        font = QtGui.QFont()
        font.setPointSize(10)
        self.CheckBox_All.setFont(font)
        self.CheckBox_All.setChecked(True)
        self.CheckBox_All.setObjectName("CheckBox_All")
        self.gridLayout.addWidget(self.CheckBox_All, 0, 0, 1, 1)
        MainWindow.setCentralWidget(self.centralwidget)
        self.menubar = QtWidgets.QMenuBar(parent=MainWindow)
        self.menubar.setGeometry(QtCore.QRect(0, 0, 865, 21))
        self.menubar.setObjectName("menubar")
        MainWindow.setMenuBar(self.menubar)
        self.statusbar = QtWidgets.QStatusBar(parent=MainWindow)
        self.statusbar.setObjectName("statusbar")
        MainWindow.setStatusBar(self.statusbar)

        self.retranslateUi(MainWindow)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)

    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "翰诚科技标书自动化平台"))
        self.label.setText(_translate("MainWindow", "目标网站"))
        self.comboBox.setItemText(0, _translate("MainWindow", "中国政府采购网（CCGP）"))
        self.comboBox.setItemText(1, _translate("MainWindow", "辽宁省政府采购网"))
        self.comboBox.setItemText(2, _translate("MainWindow", "云采通高校采购联盟"))
        self.label_2.setText(_translate("MainWindow", "关键词"))
        self.Button_AddWord.setText(_translate("MainWindow", "添加搜索词"))
        self.label_3.setText(_translate("MainWindow", "时间范围"))
        self.radio_1.setText(_translate("MainWindow", "三天内"))
        self.radio_2.setText(_translate("MainWindow", "一周内"))
        self.radio_3.setText(_translate("MainWindow", "一月内"))
        self.radio_4.setText(_translate("MainWindow", "半年内"))
        self.Button_Work.setText(_translate("MainWindow", "开始获取"))
        self.label_4.setText(_translate("MainWindow", "搜索地区"))
        self.CheckBox_JL.setText(_translate("MainWindow", "吉林"))
        self.CheckBox_ZJ.setText(_translate("MainWindow", "浙江"))
        self.CheckBox_LN.setText(_translate("MainWindow", "辽宁"))
        self.CheckBox_HLJ.setText(_translate("MainWindow", "黑龙江"))
        self.CheckBox_DL.setText(_translate("MainWindow", "大连"))
        self.CheckBox_BJ.setText(_translate("MainWindow", "北京"))
        self.CheckBox_SD.setText(_translate("MainWindow", "山东"))
        self.CheckBox_All.setText(_translate("MainWindow", "全部"))

if __name__ == '__main__':
    app = QApplication([])
    window = Ui_MainWindow()
    window.show()
    app.exec()
    pass

